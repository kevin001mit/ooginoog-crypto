<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ooginoog Terminal | Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://s3.tradingview.com/tv.js"></script>
    <style>
        /* Bloomberg-style Dark Mode */
        :root { --bg: #121418; --panel: #1b1e26; --border: #2f3342; --accent: #3b82f6; --text: #e2e8f0; }
        body { background: var(--bg); color: var(--text); font-family: 'Inter', sans-serif; overflow: hidden; }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 3px; }
        
        /* Utilities */
        .glass-panel { background: var(--panel); border: 1px solid var(--border); }
        .data-value { font-family: 'Roboto Mono', monospace; }
        .blink-red { animation: blink 2s infinite; }
        @keyframes blink { 0% { opacity: 1; } 50% { opacity: 0.5; } 100% { opacity: 1; } }
    </style>
</head>
<body class="flex flex-col h-screen">

    <div class="h-10 border-b border-gray-800 bg-black flex items-center overflow-hidden whitespace-nowrap relative">
        <div class="absolute left-0 bg-blue-700 px-3 py-2 text-xs font-bold z-10">MARKET FLOW</div>
        <div class="tradingview-widget-container w-full">
            <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-ticker-tape.js" async>
            {
            "symbols": [{"proName":"BITSTAMP:BTCUSD","title":"BTC"},{"proName":"BITSTAMP:ETHUSD","title":"ETH"},{"proName":"BINANCE:SOLUSDT","title":"SOL"},{"proName":"INDEX:DXY","title":"DXY (USD Index)"}],
            "showSymbolLogo": false, "colorTheme": "dark", "isTransparent": true, "displayMode": "regular", "locale": "en"
            }
            </script>
        </div>
    </div>

    <div class="flex-1 flex overflow-hidden">
        
        <aside class="w-72 flex flex-col border-r border-gray-800 bg-[#16181d]">
            <div class="p-4 border-b border-gray-800">
                <h1 class="text-lg font-bold tracking-tight text-white">OOGINOOG<span class="text-blue-500">.AI</span></h1>
                <div class="text-[10px] text-gray-500 flex items-center gap-1 mt-1">
                    <span class="w-2 h-2 rounded-full bg-green-500 blink-red"></span> SYSTEM LIVE
                </div>
            </div>

            <div class="p-4 space-y-4 overflow-y-auto">
                <div>
                    <h2 class="text-xs font-bold text-gray-500 uppercase mb-2">Market Phase</h2>
                    <div id="ai-phase" class="text-sm font-bold text-white bg-blue-900/30 border border-blue-500/30 p-2 rounded text-center">
                        ANALYZING...
                    </div>
                </div>

                <div class="grid grid-cols-2 gap-2">
                    <div class="bg-gray-800 p-2 rounded border border-gray-700">
                        <div class="text-[10px] text-gray-400">RESISTANCE</div>
                        <div id="ai-res" class="text-sm font-mono text-red-400 font-bold">---</div>
                    </div>
                    <div class="bg-gray-800 p-2 rounded border border-gray-700">
                        <div class="text-[10px] text-gray-400">SUPPORT</div>
                        <div id="ai-sup" class="text-sm font-mono text-green-400 font-bold">---</div>
                    </div>
                </div>

                <div>
                    <div class="flex justify-between text-xs mb-1">
                        <span class="text-gray-500">RISK SCORE</span>
                        <span id="ai-risk" class="font-bold text-orange-500">0/10</span>
                    </div>
                    <div class="h-1.5 w-full bg-gray-800 rounded-full overflow-hidden">
                        <div id="risk-bar" class="h-full bg-gradient-to-r from-green-500 via-yellow-500 to-red-500 w-0 transition-all duration-1000"></div>
                    </div>
                </div>

                <div class="mt-6 pt-6 border-t border-gray-700">
                    <h2 class="text-xs font-bold text-gray-500 uppercase mb-3">Position Sizer</h2>
                    <div class="space-y-2">
                        <input type="number" id="calc-account" placeholder="Account Size ($)" class="w-full bg-black border border-gray-700 rounded p-2 text-xs text-white focus:border-blue-500 outline-none">
                        <input type="number" id="calc-risk" placeholder="Risk % (e.g. 1)" class="w-full bg-black border border-gray-700 rounded p-2 text-xs text-white focus:border-blue-500 outline-none">
                        <input type="number" id="calc-stop" placeholder="Stop Loss % (e.g. 5)" class="w-full bg-black border border-gray-700 rounded p-2 text-xs text-white focus:border-blue-500 outline-none">
                        <button onclick="calculateSize()" class="w-full bg-blue-600 hover:bg-blue-500 text-white text-xs font-bold py-2 rounded transition">CALCULATE</button>
                    </div>
                    <div id="calc-result" class="mt-3 text-xs text-center hidden">
                        <div class="text-gray-400">Max Position Size:</div>
                        <div class="text-lg font-mono font-bold text-white">$0.00</div>
                    </div>
                </div>
            </div>
        </aside>

        <main class="flex-1 flex flex-col bg-[#0b0e11] relative">
            <div class="absolute top-4 right-4 z-20 flex bg-gray-800 rounded p-1 border border-gray-700">
                <button onclick="switchView('chart')" class="px-3 py-1 text-xs font-bold text-white bg-gray-700 rounded shadow-sm" id="btn-chart">CHART</button>
                <button onclick="switchView('heatmap')" class="px-3 py-1 text-xs font-bold text-gray-400 hover:text-white" id="btn-map">HEATMAP</button>
            </div>

            <div id="view-chart" class="w-full h-full">
                <div class="tradingview-widget-container h-full">
                    <div id="tv_chart" class="h-full"></div>
                </div>
            </div>

            <div id="view-heatmap" class="w-full h-full hidden">
                <div class="tradingview-widget-container h-full w-full">
                    <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-crypto-coins-heatmap.js" async>
                    {
                    "dataSource": "Crypto",
                    "blockSize": "market_cap_calc",
                    "blockColor": "change",
                    "locale": "en",
                    "symbolUrl": "",
                    "colorTheme": "dark",
                    "hasTopBar": false,
                    "isDataSetEnabled": false,
                    "isWidget": true,
                    "width": "100%",
                    "height": "100%"
                    }
                    </script>
                </div>
            </div>
        </main>
    </div>

    <script>
        // --- 1. VIEW SWITCHER ---
        function switchView(view) {
            document.getElementById('view-chart').classList.add('hidden');
            document.getElementById('view-heatmap').classList.add('hidden');
            document.getElementById('btn-chart').className = "px-3 py-1 text-xs font-bold text-gray-400 hover:text-white";
            document.getElementById('btn-map').className = "px-3 py-1 text-xs font-bold text-gray-400 hover:text-white";

            if(view === 'chart') {
                document.getElementById('view-chart').classList.remove('hidden');
                document.getElementById('btn-chart').className = "px-3 py-1 text-xs font-bold text-white bg-gray-700 rounded shadow-sm";
            } else {
                document.getElementById('view-heatmap').classList.remove('hidden');
                document.getElementById('btn-map').className = "px-3 py-1 text-xs font-bold text-white bg-gray-700 rounded shadow-sm";
            }
        }

        // --- 2. CALCULATOR LOGIC ---
        function calculateSize() {
            const account = parseFloat(document.getElementById('calc-account').value);
            const risk = parseFloat(document.getElementById('calc-risk').value);
            const stop = parseFloat(document.getElementById('calc-stop').value);

            if(account && risk && stop) {
                // Formula: (Account * Risk%) / StopLoss%
                const riskAmount = account * (risk / 100);
                const positionSize = riskAmount / (stop / 100);
                
                const resBox = document.getElementById('calc-result');
                resBox.classList.remove('hidden');
                resBox.querySelector('.text-lg').innerText = "$" + positionSize.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2});
            }
        }

        // --- 3. LOAD AI DATA ---
        async function loadAI() {
            try {
                const res = await fetch('sentiment.json?t=' + Date.now());
                const data = await res.json();
                
                document.getElementById('ai-phase').innerText = data.phase || "NEUTRAL";
                document.getElementById('ai-res').innerText = data.resistance || "---";
                document.getElementById('ai-sup').innerText = data.support || "---";
                document.getElementById('ai-risk').innerText = (data.risk_score || 0) + "/10";
                
                // Animate Risk Bar
                const score = data.risk_score || 0;
                document.getElementById('risk-bar').style.width = (score * 10) + "%";
                
            } catch(e) { console.log("AI Data Pending..."); }
        }

        // --- 4. INIT CHART ---
        new TradingView.widget({
            "autosize": true,
            "symbol": "BINANCE:BTCUSDT",
            "interval": "D",
            "timezone": "Etc/UTC",
            "theme": "dark",
            "style": "1",
            "locale": "en",
            "enable_publishing": false,
            "hide_side_toolbar": false,
            "container_id": "tv_chart"
        });

        loadAI();
    </script>
</body>
</html>
